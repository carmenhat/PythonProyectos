# Tras extraer el paÃ­s
# Incluiremos una columna adicional en tu DataFrame indicando si la pelÃ­cula es de:

EspaÃ±a ğŸ‡ªğŸ‡¸

Francia ğŸ‡«ğŸ‡·

Estados Unidos ğŸ‡ºğŸ‡¸

Esto lo haremos comprobando si el campo "PaÃ­ses" contiene esas etiquetas. TambiÃ©n podrÃ­amos normalizar los nombres de los paÃ­ses, por si hay variantes (â€œSpainâ€ vs â€œEspaÃ±aâ€).
paises = [c["label"] for c in pelicula.get("countries", [])]
paises_str = ", ".join(paises)

datos_peliculas.append({
    "AÃ±o": aÃ±o,
    "SecciÃ³n": nombre_seccion,
    "TÃ­tulo": pelicula.get("title", "").strip(),
    "Director": pelicula.get("director", "").strip() if pelicula.get("director") else "",
    "DuraciÃ³n": pelicula.get("duration"),
    "CategorÃ­a": pelicula.get("category", {}).get("label", ""),
    "PaÃ­ses": paises_str,
    "Enlace": f"https://www.festival-cannes.com/en/festival/films/{pelicula.get('id')}",
    "EspaÃ±a": "EspaÃ±a" in paises or "Spain" in paises,
    "Francia": "Francia" in paises or "France" in paises,
    "EEUU": "Ã‰tats-Unis" in paises or "USA" in paises or "United States" in paises
})
